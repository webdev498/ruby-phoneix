<% phx_subnav_for :m_3rdParty %>

<% provide :plan, "active" %>

<%# plan form %>

<% provide(:m_3rdParty, "active") %>

<div class="col-lg-10 phx-working-area-background">

  <%= form_for( @plan ) do |f| %>

      <!-- working area title and nav -->
      <div class="row span10 phx-working-area-nav">

        <%# temporarily disable hamburger  with  type="button" %>
        <div class="col-xs-1 phx-hamburger-box">
          <button type="button" class="phx-hamburger">|||</button>
        </div>

        <div style="height:50px;">
          <row>
            <div class="col-lg-8">
              <div class="phx-working-area-title">Third Party Management
              </div>
            </div>
            <div class="col-lg-3 phx-working-area-title-buttons">
              <p>
              </p>
            </div>
          </row>
        </div>
      </div>

      <!-- working area -->
      <div class="containter-fluid" style="padding-top:30px;">

        <!-- Primary Info -->
        <div class="col-lg-4">

          <div class="phx-primary-info-column">

            <div class="field form-group phx-input-control-ccer"> &nbsp;
            </div>

            <div class="col-md-6 form-group phx-input-control">
              <label class="phx-form-control-label" for="plan_id_code">Paytype Code</label>
              <%= f.text_field :plan_id_code, class: 'phx-form-control' %>
            </div>

            <div class="col-md-6 form-group phx-input-control">
              <label class="phx-form-control-label" for="account_number">Account Number</label>
              <%= f.text_field :account_number, class: 'phx-form-control' %>
            </div>

            <div class="field form-group phx-input-control">
              <label class="phx-form-control-label" for="insurance_plan_name">Plan Name</label>
              <%= f.text_field :insurance_plan_name, class: 'phx-form-control' %>
            </div>

            <div class="field form-group phx-input-control">
              <label class="phx-form-control-label" for="abbreviated_name">Abbreviated Name</label>
              <%= f.text_field :abbreviated_name, class: 'phx-form-control' %>
            </div>

            <div class="field form-group phx-input-control">
              <label class="phx-form-control-label" for="plan_type">Plan Type</label>
              <%= f.text_field :plan_type, class: 'phx-form-control' %>
            </div>

            <div class="field form-group phx-input-control">
              <label class="phx-form-control-label" for="payor_type">Payor Type</label>
              <%= f.text_field :payor_type, class: 'phx-form-control' %>
            </div>

            <div class="row phx-two-horizontal-controls">
              <div class="col-md-6 form-group phx-input-control">
                <label class="phx-form-control-label" for="bin_number">Bin Number</label>
                <%= f.text_field :bin_number, class: 'phx-form-control' %>
              </div>

              <div class="col-md-6 form-group phx-input-control">
                <label class="phx-form-control-label" for="processor_control_number">Proc. Control #</label>
                <%= f.text_field :processor_control_number, class: 'phx-form-control' %>
              </div>
            </div>

            <div class="row phx-two-horizontal-controls">
              <div class="col-md-6 form-group phx-input-control">
                <label class="phx-form-control-label" for="address2">Version Number</label>
                <%= f.text_field :address2, class: 'phx-form-control' %>
              </div>

              <div class="col-md-6 form-group phx-input-control">
                <label class="phx-form-control-label" for="company_id">Software ID</label>
                <%= f.text_field :company_id, class: 'phx-form-control' %>
              </div>
            </div>

            <div class="row phx-two-horizontal-controls">
              <div class="col-md-6 form-group phx-input-control">
                <label class="phx-form-control-label" for="pharmacy_id">ID Qualifier</label>
                <%= f.text_field :pharmacy_id, class: 'phx-form-control' %>
              </div>

              <div class="col-md-6 form-group phx-input-control">
                <label class="phx-form-control-label" for="provider_number">Provider ID</label>
                <%= f.text_field :provider_number, class: 'phx-form-control' %>
              </div>
            </div>

            <div class="field form-group phx-input-control">
              <label class="phx-form-control-label" for="address2">Copay Assistance Plan</label>
              <%= f.text_field :address2, class: 'phx-form-control' %>
            </div>

            <div class="field form-group phx-input-control">
              <label class="phx-form-control-label" for="copay_type">Copay Type</label>
              <%= f.text_field :copay_type, class: 'phx-form-control' %>
            </div>

            <div class="row phx-two-horizontal-controls">
              <div class="col-md-6 form-group phx-input-control">
                <label class="phx-form-control-label" for="support_split_billing">Split Bill</label>
                <%= f.text_field :support_split_billing, class: 'phx-form-control' %>
              </div>

              <div class="col-md-6 form-group phx-input-control">
                <label class="phx-form-control-label" for="split_bill_format">Split Bill Format</label>
                <%= f.text_field :split_bill_format, class: 'phx-form-control' %>
              </div>
            </div>

            <%= phx_red_submit_button_for f, "Plan", [], "", "phx-btn-model-control-width pull-right", false %>

            <div class="phx-input-control-spacer">&nbsp;</div>
            <div class="phx-input-control-spacer">&nbsp;</div>
            <div class="phx-input-control-spacer">&nbsp;</div>

          </div> <!-- end of container fluid for Primary Info -->

        </div> <!-- end of Primary Info col lg def -->

        <div class="col-lg-8">

          <!-- Tab labels -->
          <ul class="nav nav-tabs" role="tablist">
            <li class="active"><a href="#generalPane" role="tab" data-toggle="tab">General Info</a></li>
          </ul>

          <!-- Tab panes -->
          <div class="tab-content phx-tab-pane">

            <div class="tab-pane active" id="generalPane">

              <div class="container-fluid">

                <row>

                  <!-- GENERAL INFO, first column -->
                  <div class="container-fluid col-lg-4">

                    <div class="field form-group phx-input-control">
                      <label class="phx-form-control-label" for="address1">Address 1</label>
                      <%= f.text_field :address1, class: 'phx-form-control' %>
                    </div>

                    <div class="field form-group phx-input-control">
                      <label class="phx-form-control-label" for="address2">Address 2</label>
                      <%= f.text_field :address2, class: 'phx-form-control' %>
                    </div>

                    <div class="field form-group phx-input-control">
                      <label class="phx-form-control-label" for="city">City</label>
                      <%= f.text_field :city, class: 'phx-form-control' %>
                    </div>

                    <div class="row phx-two-horizontal-controls">
                      <div class="col-md-6 form-group phx-input-control">
                        <label class="phx-form-control-label" for="state">State</label>
                        <%= f.text_field :state, class: 'phx-form-control' %>
                      </div>

                      <div class="col-md-6 form-group phx-input-control">
                        <label class="phx-form-control-label" for="zip_code">Zip Code</label>
                        <%= f.text_field :zip_code, class: 'phx-form-control' %>
                      </div>
                    </div>

                    <div class="field form-group phx-input-control">
                      <label class="phx-form-control-label" for="print_sort_code">Print Sort Code</label>
                      <%= f.text_field :print_sort_code, class: 'phx-form-control' %>
                    </div>

                    <div class="field form-group phx-input-control">
                      <label class="phx-form-control-label" for="copay_type">Copay Type</label>
                      <%= f.text_field :copay_type, class: 'phx-form-control' %>
                    </div>

                    </br>
                    <%= phx_checkbox_for f, :authorization_on_label, "Authorization Number on Label" %>
                    </br>
                    <%= phx_checkbox_for f, :plan_info_on_label, "Plan Info on Label" %>
                    </br>
                    <%= phx_checkbox_for f, :submit_as_cash, "Submit as Cash" %>
                    </br>
                    <%= phx_checkbox_for f, :do_discounts_apply, "Discounts Apply" %>
                    </br>
                  </div> <!-- END OF first panel, first column -->
                </row>
              </div> <!-- END OF GENERAL INFO panel container-fluid -->
            </div>



            <!-- Modal -->
            <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
              <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h4 class="modal-title" id="myModalLabel">Select Plan</h4>
                  </div>
                  <div class="modal-body">
                    <table id ="modal_table" class="table table-hover">
                    </table>
                  </div>
                </div>
              </div>
            </div>

            <div class="tab-pane" id="claimPanel2">
              <div class="container-fluid">
                <row>
                  <!-- PLAN panel, 1st column -->
                  <div class="container-fluid col-lg-4">
                  </div> <!-- END OF SECOND panel, second column -->

                  <!-- PLAN panel, 1st column -->
                  <div class="container-fluid col-lg-4">
                  </div> <!-- END OF PLAN panel, second column -->
                </row>
              </div> <!-- END OF PLAN panel container-fluid -->
            </div>

            <div class="tab-pane" id="claimPanel3">
              <div class="container-fluid">
                <row>
                  <!-- PLAN CONT'D panel, 1st column -->
                  <div class="container-fluid col-lg-4">
                  </div> <!-- END OF SECOND panel, second column -->

                  <!-- PLAN CONT'D panel, 1st column -->
                  <div class="container-fluid col-lg-4">
                  </div> <!-- END OF PLAN CONT'D panel, second column -->
                </row>
              </div> <!-- END OF PLAN CONT'D panel container-fluid -->
            </div>
          </div>
  <% end %>
  </div> <!-- end of col lg 10 -->
  <div id="plan_search_modal_partial">
    <div id="planSearchModal">
    </div>
  </div>
<script>
  $(document).ready(function(){
      $('#plan_plan_id_code').keydown(function(evt) {
          var ch = evt.which;

          if (ch == 13) {
              $.get('getid?plan_id_code=' + $(this).val(),function(data){
                  if(data == -1 )
                      return;
                  location.href = data;
              });
          }
      });
  });
  var cs = FEENX.Search.NewSearch('plan',
      {   context:      '',
        basePath: 'search',
        fieldPrefix:  '',
        triggerField : ['insurance_plan_name','bin_number'],
        modalId:      'planSearchModal',
        hiddenDivId:  'hidden_fields',
        refresh:      true,
        refreshTo:    '/plans/' });
  cs.addHiddenFields();
  // create the corresponding data attribues in the modal rows
  cs.dataFormattedAttributes();
</script>
